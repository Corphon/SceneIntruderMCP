# SceneIntruderMCP

<div align="center">

![SceneIntruderMCP Logo](static/images/logo.png)

**ğŸ­ AIé©±åŠ¨çš„æ²‰æµ¸å¼äº’åŠ¨å™äº‹å¹³å°**

[![Go Version](https://img.shields.io/badge/Go-1.21+-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-Apache-green.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)](https://github.com/Corphon/SceneIntruderMCP)
[![Coverage](https://img.shields.io/badge/Coverage-85%25-yellow.svg)](https://codecov.io)

[English](README.md) | ç®€ä½“ä¸­æ–‡

</div>

## ğŸŒŸ é¡¹ç›®ç®€ä»‹

SceneIntruderMCP æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„AIé©±åŠ¨äº’åŠ¨å™äº‹å¹³å°ï¼Œå®ƒå°†ä¼ ç»Ÿçš„æ–‡æœ¬åˆ†æä¸ç°ä»£AIæŠ€æœ¯ç›¸ç»“åˆï¼Œä¸ºç”¨æˆ·æä¾›å‰æ‰€æœªæœ‰çš„æ²‰æµ¸å¼è§’è‰²æ‰®æ¼”å’Œæ•…äº‹åˆ›ä½œä½“éªŒã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

#### ğŸ§  **æ™ºèƒ½æ–‡æœ¬åˆ†æ**
- **å¤šç»´åº¦è§£æ**: è‡ªåŠ¨æå–åœºæ™¯ã€è§’è‰²ã€ç‰©å“ã€æƒ…èŠ‚è¦ç´ 
- **åŒè¯­æ”¯æŒ**: å®Œç¾æ”¯æŒä¸­è‹±æ–‡å†…å®¹çš„æ™ºèƒ½è¯†åˆ«å’Œå¤„ç†
- **æ·±åº¦åˆ†æ**: åŸºäºæ–‡å­¦ç†è®ºçš„ä¸“ä¸šçº§æ–‡æœ¬ç±»å‹è¯†åˆ«

#### ğŸ­ **AIè§’è‰²ç³»ç»Ÿ**
- **æƒ…æ„Ÿæ™ºèƒ½**: 8ç»´åº¦æƒ…æ„Ÿåˆ†æ (æƒ…ç»ªã€åŠ¨ä½œã€è¡¨æƒ…ã€è¯­è°ƒç­‰)
- **è§’è‰²ä¸€è‡´æ€§**: ç»´æŠ¤é•¿æœŸè®°å¿†å’Œä¸ªæ€§ç‰¹å¾
- **åŠ¨æ€äº’åŠ¨**: è§’è‰²é—´è‡ªåŠ¨è§¦å‘çš„æ™ºèƒ½å¯¹è¯

#### ğŸ“– **åŠ¨æ€æ•…äº‹å¼•æ“**
- **éçº¿æ€§å™äº‹**: æ”¯æŒå¤æ‚çš„æ•…äº‹åˆ†æ”¯å’Œæ—¶é—´çº¿ç®¡ç†
- **æ™ºèƒ½é€‰æ‹©ç”Ÿæˆ**: AIåŸºäºä¸Šä¸‹æ–‡åŠ¨æ€åˆ›å»º4ç±»é€‰æ‹© (è¡ŒåŠ¨/å¯¹è¯/æ¢ç´¢/ç­–ç•¥)
- **æ•…äº‹å›æº¯**: å®Œæ•´çš„æ—¶é—´çº¿å›æ»šå’ŒçŠ¶æ€ç®¡ç†

#### ğŸ® **æ¸¸æˆåŒ–ä½“éªŒ**
- **ç”¨æˆ·å®šåˆ¶**: è‡ªå®šä¹‰é“å…·å’ŒæŠ€èƒ½ç³»ç»Ÿ
- **åˆ›æ„æ§åˆ¶**: 3çº§åˆ›æ„ç¨‹åº¦æ§åˆ¶ (ä¸¥æ ¼/å¹³è¡¡/æ‰©å±•)
- **è¿›åº¦è¿½è¸ª**: å®æ—¶æ•…äº‹å®Œæˆåº¦å’Œç»Ÿè®¡åˆ†æ

#### ğŸ”— **å¤šLLMæ”¯æŒ**
- **OpenAI GPT**: GPT-4.1/4o ç³»åˆ—
- **Anthropic Claude**: Claude-4/3.7 ç³»åˆ—
- **DeepSeek**: ä¸­æ–‡ä¼˜åŒ–æ¨¡å‹
- **Google Gemini**: Gemini-2.5/2.0 ç³»åˆ—
- **Grok**: xAIçš„Grok3/2æ¨¡å‹
- **Mistral**: Mistralç³»åˆ—æ¨¡å‹
- **Qwen**: é˜¿é‡Œäº‘åƒé—®qwen3ç³»åˆ—
- **GitHub Models**: é€šè¿‡GitHub Modelså¹³å°
- **OpenRouter**: å¼€æºæ¨¡å‹èšåˆå¹³å°
- **GLM**: æ™ºè°±AIçš„GLM-4ç³»åˆ—

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ğŸ“ é¡¹ç›®ç»“æ„

```
SceneIntruderMCP/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/           # åº”ç”¨ç¨‹åºå…¥å£
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/              # HTTP API è·¯ç”±å’Œå¤„ç†å™¨
â”‚   â”œâ”€â”€ app/              # åº”ç”¨ç¨‹åºæ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ di/               # ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ llm/              # LLMæä¾›å•†æŠ½è±¡å±‚
â”‚   â”‚   â””â”€â”€ providers/    # å„ç§LLMæä¾›å•†å®ç°
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â””â”€â”€ storage/          # å­˜å‚¨æŠ½è±¡å±‚
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/              # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/               # å‰ç«¯JavaScript
â”‚   â””â”€â”€ images/           # é™æ€å›¾ç‰‡
â”œâ”€â”€ web/
â”‚   â””â”€â”€ templates/        # HTMLæ¨¡æ¿
â”œâ”€â”€ data/                 # æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ scenes/           # åœºæ™¯æ•°æ®
â”‚   â”œâ”€â”€ stories/          # æ•…äº‹æ•°æ®
â”‚   â”œâ”€â”€ users/            # ç”¨æˆ·æ•°æ®
â”‚   â””â”€â”€ exports/          # å¯¼å‡ºæ–‡ä»¶
â””â”€â”€ logs/                 # åº”ç”¨æ—¥å¿—
```

### ğŸ”§ æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **åç«¯**: Go 1.21+, Gin Web Framework
- **AIé›†æˆ**: å¤šLLMæä¾›å•†æ”¯æŒï¼Œç»Ÿä¸€æŠ½è±¡æ¥å£
- **å­˜å‚¨**: åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„JSONå­˜å‚¨ï¼Œæ”¯æŒæ‰©å±•åˆ°æ•°æ®åº“
- **å‰ç«¯**: åŸç”ŸJavaScript + HTML/CSSï¼Œå“åº”å¼è®¾è®¡
- **éƒ¨ç½²**: å®¹å™¨åŒ–æ”¯æŒï¼Œäº‘åŸç”Ÿæ¶æ„

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Go 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- è‡³å°‘ä¸€ä¸ªLLM APIå¯†é’¥ (OpenAI/Claude/DeepSeekç­‰)
- 2GB+ å¯ç”¨å†…å­˜
- æ“ä½œç³»ç»Ÿ: Windows/Linux/macOS

### ğŸ“¦ å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/Corphon/SceneIntruderMCP.git
cd SceneIntruderMCP
```

2. **å®‰è£…ä¾èµ–**
```bash
go mod download
```

3. **é…ç½®ç¯å¢ƒ**
```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp data/config.json.example data/config.json

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ APIå¯†é’¥
nano data/config.json
```

4. **å¯åŠ¨æœåŠ¡**
```bash
# å¼€å‘æ¨¡å¼
go run cmd/server/main.go

# ç”Ÿäº§æ¨¡å¼
go build -o sceneintruder cmd/server/main.go
./sceneintruder
```

5. **è®¿é—®åº”ç”¨**
```
æµè§ˆå™¨æ‰“å¼€: http://localhost:8080
```

### âš™ï¸ é…ç½®è¯´æ˜

#### `data/config.json` é…ç½®ç¤ºä¾‹

```json
{
  "llm": {
    "default_provider": "openai",
    "providers": {
      "openai": {
        "api_key": "your-openai-api-key",
        "base_url": "https://api.openai.com/v1",
        "default_model": "gpt-4"
      },
      "anthropic": {
        "api_key": "your-claude-api-key", 
        "default_model": "claude-3-5-sonnet-20241022"
      },
      "deepseek": {
        "api_key": "your-deepseek-api-key",
        "default_model": "deepseek-chat"
      }
    }
  },
  "server": {
    "port": 8080,
    "debug": false
  },
  "storage": {
    "data_path": "./data"
  }
}
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ğŸ¬ åˆ›å»ºåœºæ™¯

1. **ä¸Šä¼ æ–‡æœ¬**: æ”¯æŒå°è¯´ã€å‰§æœ¬ã€æ•…äº‹ç­‰å¤šç§æ–‡æœ¬æ ¼å¼
2. **AIåˆ†æ**: ç³»ç»Ÿè‡ªåŠ¨æå–è§’è‰²ã€åœºæ™¯ã€ç‰©å“ç­‰è¦ç´ 
3. **åœºæ™¯ç”Ÿæˆ**: åˆ›å»ºå¯äº¤äº’çš„åœºæ™¯ç¯å¢ƒ

### ğŸ­ è§’è‰²äº’åŠ¨

1. **é€‰æ‹©è§’è‰²**: ä»åˆ†æå‡ºçš„è§’è‰²ä¸­é€‰æ‹©äº’åŠ¨å¯¹è±¡
2. **è‡ªç„¶å¯¹è¯**: ä¸AIè§’è‰²è¿›è¡Œè‡ªç„¶è¯­è¨€å¯¹è¯
3. **æƒ…æ„Ÿåé¦ˆ**: è§‚å¯Ÿè§’è‰²çš„æƒ…ç»ªã€åŠ¨ä½œå’Œè¡¨æƒ…å˜åŒ–

### ğŸ“š æ•…äº‹åˆ†æ”¯

1. **åŠ¨æ€é€‰æ‹©**: AIæ ¹æ®å½“å‰æƒ…å†µç”Ÿæˆ4ç§ç±»å‹çš„é€‰æ‹©
2. **æ•…äº‹å‘å±•**: åŸºäºé€‰æ‹©æ¨è¿›éçº¿æ€§æ•…äº‹æƒ…èŠ‚
3. **åˆ†æ”¯ç®¡ç†**: æ”¯æŒæ•…äº‹å›æº¯å’Œå¤šåˆ†æ”¯æ¢ç´¢

### ğŸ“Š æ•°æ®å¯¼å‡º

1. **äº¤äº’è®°å½•**: å¯¼å‡ºå®Œæ•´çš„å¯¹è¯å†å²
2. **æ•…äº‹æ–‡æ¡£**: ç”Ÿæˆç»“æ„åŒ–çš„æ•…äº‹æ–‡æ¡£
3. **ç»Ÿè®¡åˆ†æ**: è§’è‰²äº’åŠ¨å’Œæ•…äº‹è¿›å±•ç»Ÿè®¡

## ğŸ› ï¸ APIæ–‡æ¡£

### ğŸ”— å®é™…å¯ç”¨çš„APIç«¯ç‚¹

#### åœºæ™¯ç®¡ç†
```http
GET    /api/scenes                    # è·å–åœºæ™¯åˆ—è¡¨
POST   /api/scenes                    # åˆ›å»ºåœºæ™¯  
GET    /api/scenes/{id}               # è·å–åœºæ™¯è¯¦æƒ…
GET    /api/scenes/{id}/characters    # è·å–åœºæ™¯è§’è‰²
GET    /api/scenes/{id}/aggregate     # è·å–åœºæ™¯èšåˆæ•°æ®
```

#### æ–‡æœ¬åˆ†æ
```http
POST   /api/analyze                   # åˆ†ææ–‡æœ¬å†…å®¹
GET    /api/progress/{taskID}         # è·å–åˆ†æè¿›åº¦
POST   /api/cancel/{taskID}           # å–æ¶ˆåˆ†æä»»åŠ¡
POST   /api/upload                    # ä¸Šä¼ æ–‡ä»¶
```

#### è§’è‰²äº’åŠ¨
```http
POST   /api/chat                      # ä¸è§’è‰²å¯¹è¯
POST   /api/interactions/trigger      # è§¦å‘è§’è‰²äº’åŠ¨
POST   /api/interactions/simulate     # æ¨¡æ‹Ÿè§’è‰²å¯¹è¯
POST   /api/interactions/aggregate    # èšåˆäº¤äº’å¤„ç†
GET    /api/interactions/{scene_id}   # è·å–äº’åŠ¨å†å²
GET    /api/conversations/{scene_id}  # è·å–å¯¹è¯å†å²
```

#### ç³»ç»Ÿé…ç½®
```http
GET    /api/settings                  # è·å–ç³»ç»Ÿè®¾ç½®
POST   /api/settings                  # æ›´æ–°ç³»ç»Ÿè®¾ç½®
POST   /api/settings/test-connection  # æµ‹è¯•è¿æ¥
GET    /api/llm/models               # è·å–å¯ç”¨æ¨¡å‹
```

#### ç”¨æˆ·é“å…·å’ŒæŠ€èƒ½ç³»ç»Ÿ
```http
GET    /api/users/{user_id}/items           # è·å–ç”¨æˆ·é“å…·
POST   /api/users/{user_id}/items          # æ·»åŠ ç”¨æˆ·é“å…·
GET    /api/users/{user_id}/items/{item_id} # è·å–ç‰¹å®šé“å…·
PUT    /api/users/{user_id}/items/{item_id} # æ›´æ–°ç”¨æˆ·é“å…·
DELETE /api/users/{user_id}/items/{item_id} # åˆ é™¤ç”¨æˆ·é“å…·

GET    /api/users/{user_id}/skills           # è·å–ç”¨æˆ·æŠ€èƒ½
POST   /api/users/{user_id}/skills          # æ·»åŠ ç”¨æˆ·æŠ€èƒ½
GET    /api/users/{user_id}/skills/{skill_id} # è·å–ç‰¹å®šæŠ€èƒ½
PUT    /api/users/{user_id}/skills/{skill_id} # æ›´æ–°ç”¨æˆ·æŠ€èƒ½
DELETE /api/users/{user_id}/skills/{skill_id} # åˆ é™¤ç”¨æˆ·æŠ€èƒ½
```

è¯¦ç»†APIæ–‡æ¡£è¯·å‚è€ƒ: [APIæ–‡æ¡£](docs/api_cn.md)

## ğŸ§ª å¼€å‘æŒ‡å—

### ğŸƒâ€â™‚ï¸ è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/services/...
```

### ğŸ”§ æ·»åŠ æ–°çš„LLMæä¾›å•†

1. **å®ç°æ¥å£**: åœ¨ `internal/llm/providers/` åˆ›å»ºæ–°æä¾›å•†
2. **æ³¨å†Œæä¾›å•†**: åœ¨ `init()` å‡½æ•°ä¸­æ³¨å†Œ
3. **æ·»åŠ é…ç½®**: æ›´æ–°é…ç½®æ–‡ä»¶æ¨¡æ¿
4. **ç¼–å†™æµ‹è¯•**: æ·»åŠ å¯¹åº”çš„å•å…ƒæµ‹è¯•

### ğŸ“ ä»£ç ç»“æ„è¯´æ˜

- **models/**: æ•°æ®æ¨¡å‹ï¼Œå®šä¹‰ç³»ç»Ÿä¸­çš„æ ¸å¿ƒå®ä½“
- **services/**: ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¤„ç†æ ¸å¿ƒåŠŸèƒ½
- **api/**: HTTPå¤„ç†å™¨ï¼Œæš´éœ²RESTful API
- **llm/**: LLMæŠ½è±¡å±‚ï¼Œæ”¯æŒå¤šä¸ªAIæä¾›å•†

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### ğŸš€ ç³»ç»Ÿæ€§èƒ½

- **å¹¶å‘å¤„ç†**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶è®¿é—®
- **ç¼“å­˜æœºåˆ¶**: LLMå“åº”æ™ºèƒ½ç¼“å­˜
- **å†…å­˜ä¼˜åŒ–**: æŒ‰éœ€åŠ è½½ï¼Œé¿å…å†…å­˜æ³„æ¼
- **æ–‡ä»¶å‹ç¼©**: è‡ªåŠ¨å‹ç¼©å†å²æ•°æ®

### ğŸ“Š ç›‘æ§æŒ‡æ ‡

- **APIä½¿ç”¨ç»Ÿè®¡**: è¯·æ±‚æ¬¡æ•°å’ŒTokenæ¶ˆè€—
- **å“åº”æ—¶é—´**: AIæ¨¡å‹å“åº”é€Ÿåº¦ç›‘æ§
- **é”™è¯¯ç‡**: ç³»ç»Ÿé”™è¯¯å’ŒAPIé”™è¯¯è¿½è¸ª
- **èµ„æºä½¿ç”¨**: CPUå’Œå†…å­˜ä½¿ç”¨ç›‘æ§

## ğŸ” å®‰å…¨è€ƒè™‘

### ğŸ›¡ï¸ æ•°æ®å®‰å…¨

- **APIå¯†é’¥**: å®‰å…¨å­˜å‚¨ï¼Œæ”¯æŒç¯å¢ƒå˜é‡
- **ç”¨æˆ·æ•°æ®**: æœ¬åœ°å­˜å‚¨ï¼Œå®Œå…¨éšç§æ§åˆ¶
- **è®¿é—®æ§åˆ¶**: æ”¯æŒç”¨æˆ·ä¼šè¯å’Œæƒé™ç®¡ç†
- **æ•°æ®å¤‡ä»½**: è‡ªåŠ¨å¤‡ä»½é‡è¦æ•°æ®

### ğŸ”’ ç½‘ç»œå®‰å…¨

- **HTTPSæ”¯æŒ**: ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨HTTPS
- **CORSé…ç½®**: è·¨åŸŸèµ„æºå…±äº«å®‰å…¨é…ç½®
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„ç”¨æˆ·è¾“å…¥éªŒè¯å’Œæ¸…ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

### ğŸ“ è´¡çŒ®æ–¹å¼

1. **BugæŠ¥å‘Š**: ä½¿ç”¨ GitHub Issues æŠ¥å‘Šé—®é¢˜
2. **åŠŸèƒ½å»ºè®®**: æå‡ºæ–°åŠŸèƒ½çš„æƒ³æ³•å’Œå»ºè®®
3. **ä»£ç è´¡çŒ®**: æäº¤ Pull Request
4. **æ–‡æ¡£æ”¹è¿›**: å¸®åŠ©æ”¹è¿›æ–‡æ¡£å’Œç¤ºä¾‹

### ğŸ”§ å¼€å‘æµç¨‹

1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. åˆ›å»º Pull Request

### ğŸ“‹ ä»£ç è§„èŒƒ

- éµå¾ª Go å®˜æ–¹ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ–°åŠŸèƒ½
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

### ğŸ¯ æ ¸å¿ƒæŠ€æœ¯

- [Go](https://golang.org/) - é«˜æ€§èƒ½ç¼–ç¨‹è¯­è¨€
- [Gin](https://gin-gonic.com/) - è½»é‡çº§Webæ¡†æ¶
- [OpenAI](https://openai.com/) - GPTç³»åˆ—æ¨¡å‹
- [Anthropic](https://anthropic.com/) - Claudeç³»åˆ—æ¨¡å‹

### ğŸ‘¥ ç¤¾åŒºæ”¯æŒ

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç”¨æˆ·ï¼

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: [GitHub Repository](https://github.com/Corphon/SceneIntruderMCP)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/Corphon/SceneIntruderMCP/issues)
- **åŠŸèƒ½å»ºè®®**: [GitHub Discussions](https://github.com/Corphon/SceneIntruderMCP/discussions)
- **é‚®ä»¶è”ç³»**: [songkf@foxmail.com](mailto:songkf@foxmail.com)

---

<div align="center">

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ç»™å®ƒä¸€ä¸ªStarï¼ ğŸŒŸ**

Made with â¤ï¸ by SceneIntruderMCP Team

</div>
